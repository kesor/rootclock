#!/usr/bin/env bash
set -euo pipefail

files=(rootclock.c config.def.h)

if ! command -v clang-format >/dev/null 2>&1; then
  printf 'clang-format not found in PATH. Please install it or adjust the dev shell.\n' >&2
  exit 1
fi

dirty=0
for file in "${files[@]}"; do
  if [ -f "$file" ]; then
    clang-format -i "$file"
    git add "$file"
    dirty=1
  fi
done

if [ "$dirty" -eq 1 ]; then
  printf 'clang-format applied to C sources. Changes have been staged.\n'
fi
